<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta http-equiv="content-type" name="viewport" charset="utf-8" content="text/html; width=device-width, initial-scale=1">
  <title>One Music (YouTube)</title>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/results.css">
  <link rel="icon" href="img/logo/one_music-short-4.0.svg" type="image/svg+xml">
</head>

<body>

  <section class="bodyContainer">

    <a href="/"><img class="logo" src="./img/logo/one_music-short-4.0.svg" alt="One Music"></a>

    <!-- POST request to fetch data related to queryValue.  -->
    <form class="searchForm" action="/" method="post">
      <div class="searchInputContainer">
        <input class="searchInput" id="queryId" type="search" name="queryValue" placeholder="Search" autocomplete="off" value="<%= queryEjs %>" required>
        <button class="searchButton" type="submit" name="button">
          &#5125;&#xFE0E;
        </button>
      </div>
    </form>

    <section class="contentContainer">

      <a class="loginPrompt" href="auth/spotify"><em>Login with Spotify for better results.</em></a>

      <div class="nowPlayingContainer"></div>

      <h3 class="itemHeading">Watch</h3>
      <% for(i = 0; i < Object.keys(ytQueryEjs.id).length; i++) { %>
      <div id="ytQueryEjs<%= i %>" class="item">
        <img class="itemThumb itemThumbVideo" src="<%= ytQueryEjs.thumb[i] %>" width="" height="" alt="">
        <div class="itemInfo">
          <p class="itemTitle"><%= ytQueryEjs.title[i] %><br></p>
          <p class="itemChannel"><%= ytQueryEjs.channel[i] %></p>
        </div>
      </div>
      <% } %>

      <h3 class="itemHeading">Cover</h3>
      <% for(i = 0; i < Object.keys(ytCoverUniqueEjs.id).length; i++) { %>
      <div id="ytCoverUniqueEjs<%= i %>" class="item">
        <img class="itemThumb itemThumbVideo" src="<%= ytCoverUniqueEjs.thumb[i] %>" width="" height="" alt="">
        <div class="itemInfo">
          <p class="itemTitle"><%= ytCoverUniqueEjs.title[i] %><br></p>
          <p class="itemChannel"><%= ytCoverUniqueEjs.channel[i] %></p>
        </div>
      </div>
      <% } %>

      <h3 class="itemHeading">Live</h3>
      <% for(i = 0; i < Object.keys(ytLiveUniqueEjs.id).length; i++) { %>
      <div id="ytLiveUniqueEjs<%= i %>" class="item">
        <img class="itemThumb itemThumbVideo" src="<%= ytLiveUniqueEjs.thumb[i] %>" width="" height="" alt="">
        <div class="itemInfo">
          <p class="itemTitle"><%= ytLiveUniqueEjs.title[i] %><br></p>
          <p class="itemChannel"><%= ytLiveUniqueEjs.channel[i] %></p>
        </div>
      </div>
      <% } %>

    </section>

    <section class="footer">

      <hr>

      <div class="downloads">
        <!-- <img class="pwa" src="./img/app_store/pwa.png" alt="pwa_badge" /> -->
        <img class="googlePlay" src="./img/app_store/google_play.png" alt="google_play_badge" />
        <img class="appStore" src="./img/app_store/app_store.svg" alt="app_store_badge" />
      </div>

    </section>

  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

  <script type="text/javascript">
  if($(window).width() > 767) {
    $(".logo").attr("src", "./img/logo/one_music-short-4.0-long-2.0.svg");
  }

  $('.item').hover(function(){
        $(this).animate({'backgroundColor': '#171717'}, 100);
    }, function(){
        $(this).animate({'backgroundColor': 'black'}, 200);
    });

  <% for(i = 0; i < Object.keys(ytQueryEjs).length ;i++) { %>
    $("#ytQueryEjs<%= i %>").on("click", () => {
      $(".nowPlayingContainer").html(
        "<h3 class='itemHeading' style='padding-top: 1rem; margin-top: 0rem; margin-bottom: 1rem;'>Now Playing</h3><div class='nowPlayingYt'></div>"
      )
      $(".nowPlayingYt").html("<iframe width='560' height='315' src='https://www.youtube.com/embed/<%= ytQueryEjs.id[i] %>' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe>");
      $('html, body').animate({
        scrollTop: $(".nowPlayingContainer").offset().top
    }, 50);
    });
  <% } %>

  <% for(i = 0; i < Object.keys(ytCoverUniqueEjs).length ;i++) { %>
    $("#ytCoverUniqueEjs<%= i %>").on("click", () => {
      $(".nowPlayingContainer").html(
        "<h3 class='itemHeading' style='padding-top: 1rem; margin-top: 0rem; margin-bottom: 1rem;'>Now Playing</h3><div class='nowPlayingYt'></div>"
      )
      $(".nowPlayingYt").html("<iframe width='560' height='315' src='https://www.youtube.com/embed/<%= ytCoverUniqueEjs.id[i] %>' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe>");
      $('html, body').animate({
        scrollTop: $(".nowPlayingContainer").offset().top
      }, 50);
    });
  <% } %>

  <% for(i = 0; i < Object.keys(ytLiveUniqueEjs).length ;i++) { %>
    $("#ytLiveUniqueEjs<%= i %>").on("click", () => {
      $(".nowPlayingContainer").html(
        "<h3 class='itemHeading' style='padding-top: 1rem; margin-top: 0rem; margin-bottom: 1rem;'>Now Playing</h3><div class='nowPlayingYt'></div>"
      )
      $(".nowPlayingYt").html("<iframe width='560' height='315' src='https://www.youtube.com/embed/<%= ytLiveUniqueEjs.id[i] %>' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe>");
      $('html, body').animate({
        scrollTop: $(".nowPlayingContainer").offset().top
      }, 50);
    });
  <% } %>

  </script>

</body>

</html>
